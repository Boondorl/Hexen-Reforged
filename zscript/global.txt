class GlobalEventsHandler : EventHandler
{
	override void WorldThingSpawned(WorldEvent e)
	{
		if (!e.thing)
			return;
		
		if (e.thing.bMissile && e.thing.target && e.thing.target.player)
		{
			for (int i = 0; i < players.Size(); ++i)
			{
				if (!playerInGame[i])
					continue;
				
				let bm = BuffManager(players[i].mo.FindInventory("BuffManager"));
				if (bm)
				{
					for (int j = 0; j < bm.buffs.Size(); ++j)
					{
						if (bm.buffs[j])
							bm.buffs[j].MissileFired(e.thing);
					}
				}
			}
		}
		else if (e.thing is "Inventory")
		{
			if (e.thing is "ArtiEgg" || e.thing is "ArtiHealingRadius" || e.thing is "ArtiDarkServant")
				e.thing.Destroy();
			else if (e.thing is "PuzzleItem")
				Inventory(e.thing).bInvBar = false;
		}
	}
	
	override void WorldThingDied(WorldEvent e)
	{
		for (int i = 0; i < players.Size(); ++i)
		{
			if (!playerInGame[i])
				continue;
			
			let bm = BuffManager(players[i].mo.FindInventory("BuffManager"));
			if (bm)
			{
				for (int j = 0; j < bm.buffs.Size(); ++j)
				{
					if (bm.buffs[j])
						bm.buffs[j].ThingDied(e.thing, e.inflictor);
				}
			}
		}
	}
}